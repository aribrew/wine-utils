#!/bin/bash

source bash_helpers.sh

if ! [[ -v BASH_HELPERS_LOADED ]];
then
    echo -e "BASH Helpers not found in PATH. Install them first.\n"
    exit 1
fi




PREFIX=$(realpath $(dirname $0))


if [[ -d "$PREFIX/dosdevices" ]]; 
then
    if [[ -d "$PREFIX/drive_c/Program Files (x86)" ]]; 
    then
        ln -sf "$PREFIX" "$HOME/.wine64"

        if ! [[ "$?" == "0" ]]; 
        then
            abort "Failed creating ~/.wine64 symlink. A real dir exists?"
        fi

        echo "This WINE prefix is now the default for running 64 bit apps."
        echo ""

    else
        ln -sf "$PREFIX" "$HOME/.wine"

        if ! [[ "$?" == "0" ]]; 
        then
            abort "Failed creating ~/.wine symlink. A real dir exists?"
        fi

        echo "This WINE prefix is now the default for running 32 bit apps."
        echo ""
    fi
fi
